import { Component, OnInit } from '@angular/core';
import { ActivatedRoute, Router } from '@angular/router';
import { ApiService } from 'src/app/services/api.service';
import { UtilService } from 'src/app/services/util.service';

@Component({
  selector: 'app-directory-city',
  templateUrl: './directory-city.component.html',
  styleUrls: ['./directory-city.component.scss']
})
export class DirectoryCityComponent implements OnInit {
  countryCode
  stateCode
  cityData
  page: number = 1;
  constructor(private aroute: ActivatedRoute,private api: ApiService, private router: Router, private util:UtilService) {
    this.aroute.params.subscribe(res => {
      this.countryCode = res.countryId;
      this.stateCode = res.stateId;
    })
   }

  ngOnInit() {
    window.scroll({
      top: 0,
      left: 0,
      behavior: 'smooth'})
      this.getCity()
  }


  cityclick(cityData){
    var res = this.router.url.substring(1, 14);
    if(res=="directory/hcp"){
      this.router.navigate(['/directory/hcp/country/' +this.countryCode +'/state/'+this.stateCode +'/city/'+cityData.cityName +'/professional']);

    }else if(res=="directory/hco"){
       this.router.navigate(['/directory/hco/country/' +this.countryCode +'/state/'+this.stateCode +'/city/'+cityData.cityName +'/profilelist']);

     }
  }


  getCity(){
    this.util.startLoader()
      this.api.query('country/'+ this.countryCode +'/'+ this.stateCode ).subscribe(res=>{
        this.util.stopLoader()
        if(res != null){
          this.cityData = res
        }else{

        }

      },err => {
        this.util.stopLoader(); 
      })
    }

}
